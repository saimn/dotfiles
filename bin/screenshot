#!/bin/bash
#
# Screenshooter
# by Michael Williams <http://github.com/mykeus>
#
# This Script is ment to be binded with hotkeys under a *nix environment.
# Basically, Takes the screenshot & Uploads it via sftp & copies true url
# to the clipboard.
#
# Install:
# sudo chmod +x screenshooter.sh && mv screenshooter.sh /usr/bin/screenshooter
#
# Usage: {full|selection|delay}
#

host="" # sftp host
username="" # sftp username
rpath="" # remote path
url="" # http url to screenshot
delay="5" # In seconds, example "5" = 5 Seconds
mime="jpg" # jpg, png

####
# Do not edit below this point
####

# Create Filename Hash
# Generates Random Filename
hash=`mktemp XXXXXX` || exit 1
shot=$hash.$mime


full() {
    cd /tmp;
    /usr/bin/scrot $shot;
    touch upload.bat;
    echo "cd $rpath" > upload.bat;
    echo "put $shot" >> upload.bat;
    echo "bye" >> upload.bat;
    sftp -b upload.bat $username@$host
    rm -r upload.bat;
    rm -r ~/$hash;
    notify-send "Screenshot Uploaded" "$siteURL$shot";
    echo "Uploaded via sftp to $url$shot";
    echo "$url$shot" | xclip -selection clipboard;
    rm -r $shot;
}

#
# Selective Area Screenshot
# Hold Left Mouse Button and Drag
#
selection() {
    cd /tmp;
    /usr/bin/scrot -s $shot;
    touch upload.bat;
    echo "cd $rpath" > upload.bat;
    echo "put $shot" >> upload.bat;
    echo "bye" >> upload.bat;
    sftp -b upload.bat $username@$host
    rm -r upload.bat;
    rm -r ~/$hash;
    notify-send "Screenshot Uploaded" "$siteURL$shot";
    echo "Uploaded via sftp to $url$shot";
    echo "$url$shot" | xclip -selection clipboard;
    rm -r $shot;
}

delay() {
    sleep $delay;
}

case "$1" in
   full)
        full
        ;;
    selection)
        selection
        ;;
    delay)
        delay
        full
        ;;
          *)
        echo "Usage: {full|selection|delay}"
        exit 1
        ;;
esac
exit $?
